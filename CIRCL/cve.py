#!/usr/bin/env python


# Headers
import os
import sys
import json
import urllib3
import requests
import pandas as pd

from datetime import datetime
from datetime import timezone
from datetime import timedelta
from cveurls import cveurl_query
from cveurls import cveurl_cveid
from cveurls import cveurl_dbinfo
from cveurls import cveurl_cwe
from cveurls import cveurl_capec

# Suppress request warnings
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

# Current Date & Time
current_DT = datetime.now().strftime("%Y-%m-%d")
current_TIME = datetime.now().strftime("%H:%M")

# Function to get the last CVE information
def cve_INFO(numbers):
	get_INFO = json.loads(json.dumps(requests.get(cveurl_query+str(numbers),verify=False,allow_redirects=False).json()))
	return get_INFO

# Function to get the CVE information
def cveid_INFO(cveid):
	get_INFO = json.loads(json.dumps(requests.get(cveurl_cveid+cveid,verify=False,allow_redirects=False).json()))
	return get_INFO

# Function to get the CVE Databases information
def cvedb_INFO():
	get_INFO = json.loads(json.dumps(requests.get(cveurl_dbinfo,verify=False,allow_redirects=False).json()))
	return get_INFO

# Function to get the CWE information
def cvecwe_INFO():
	get_INFO = json.loads(json.dumps(requests.get(cveurl_cwe,verify=False,allow_redirects=False).json()))
	return get_INFO

# Function to get the CAPEC information
def cvecapec_INFO(numbers):
	get_INFO = json.loads(json.dumps(requests.get(cveurl_capec+str(numbers),verify=False,allow_redirects=False).json()))
	return get_INFO
